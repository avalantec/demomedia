<odoo>
    <data>

    <record model="ir.ui.view" id="webform_get.get_code">

        <field name="name">WEB form GET</field>
        <field name="inherit_id" ref="website.user_navbar"/>
        
        <field name="arch" type="xml">

            <xpath expr="//li[@id='customize-menu']/div" position="inside">
                
                <a role="menuitem" class="dropdown-item" id="button_get_form">Get Form Code3</a>
                    
                    <script type="text/javascript" src="https://code.jquery.com/jquery-1.7.1.min.js"></script>
                    <script type="text/javascript">
                        $(document).ready( function() {
                            odoo.define('website.get_form_code', function (require) {
                            'use strict';
                            var Dialog = require('web.Dialog');

                            var button = $('#button_get_form');
                            button.click(function() {
                                const form_all = document.querySelectorAll('form');
                                if ( form_all.length == 0 ) {
                                    console.log("No Form Detected");
                                    Dialog.alert(this,"No Form Detected");
                                    return
                                }

                                var data_model_name = form_all[0].getAttribute('data-model_name');
                                var form_action = form_all[0].action + data_model_name;

                                var f = document.createElement("form");
                                f.setAttribute('method',form_all[0].method);
                                f.setAttribute('action',form_action);
                                f.setAttribute('enctype','multipart/form-data');

                                var data_values_element = document.querySelectorAll('[data-values]');
                                var data_values_txt = data_values_element[0].getAttribute('data-values');
                                if ( data_values_txt ) {
                                    var data_values_txt = data_values_txt.replaceAll("'", "\"");
                                    var data_values_txt = data_values_txt.replaceAll("False", "false");
                                    console.log('If error remove the space, change from " False" to "False" ');
                                    var data_values_json = JSON.parse( data_values_txt);
                                }
                        
                                jQuery.each(data_values_json, function(key, value){
                                    if ( value != "") {
                                        var data_value = document.createElement( "input" );
                                        data_value.name = key;
                                        data_value.value = value;
                                        data_value.type = "hidden";
                                        data_value.class = "input";
                                        f.appendChild(  data_value );
                                    }
                                })

                                var data_success_page = form_all[0].getAttribute('data-success-page');
                                var url_redirect = document.createElement("input");
                                url_redirect.type = "hidden"
                                url_redirect.name = "data_success_page"
                                url_redirect.value = data_success_page
                                url_redirect.class = "input"

                                f.appendChild(  url_redirect );

                                var inputs = form_all[0].querySelectorAll("input, textarea");
                                for (var input of inputs) {
                                    var new_input = input.cloneNode(true);
                                    new_input.removeAttribute("class");
                                    f.appendChild(  new_input );
                                    f.appendChild(document.createElement("br"));
                                };

                                var input_submit = document.createElement("input");
                                input_submit.setAttribute('type',"submit");
                                input_submit.setAttribute('value',"Submit");

                                f.appendChild( input_submit );

                                Dialog.alert(this, f.outerHTML);
                                let text = f.outerHTML;
                                let textArea = document.createElement('textarea');
                                textArea.width = "1px";
                                textArea.heigth = "1px";
                                textArea.background = "transparents";
                                textArea.value = text;
                                document.body.append( textArea );
                                textArea.select();
                                document.execCommand( 'copy' );
                                document.body.removeChild( textArea );
                                return

                            })

                        })
                    })

                </script>

            </xpath>

        </field>
        
    </record>      
  
	

    </data>
</odoo>
